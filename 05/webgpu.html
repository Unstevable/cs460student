<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>CS460 – WebGPU with Babylon.js</title>

    <style>
      html,
      body {
        margin: 0;          
        padding: 0;         
        width: 100%;
        height: 100%;
        overflow: hidden;   
        background: #000;  
      }

      #renderCanvas {
        width: 100%;
        height: 100%;
        display: block;    
      }
    </style>

    <!-- Babylon core library -->
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <!-- glTF / GLB loader for Babylon -->
    <script src="https://cdn.babylonjs.com/loaders/babylon.glTF2FileLoader.min.js"></script>
  </head>

  <body>
    <!-- Our WebGPU render target -->
    <canvas id="renderCanvas"></canvas>

    <script type="module">
      // wrap everything in an async function so we can use "await"
      async function start() {
        // get a reference to the canvas in the DOM
        const canvas = document.getElementById('renderCanvas');

        // Create a Babylon WebGPU engine for this canvas
        let engine = new BABYLON.WebGPUEngine(canvas, { antialiasing: true });

        // initialize WebGPU; MUST be awaited before creating a scene
        await engine.initAsync();

        // create a new Babylon scene using this engine
        const scene = new BABYLON.Scene(engine);

        // Load the Polycam GLB file (poly.glb must be in the SAME folder as webgpu.html)
        await BABYLON.SceneLoader.AppendAsync('', 'poly.glb', scene);

        // Create a default camera and light so we can actually see the model
        // (true,true,true) = create both camera and light, automatically adjusted
        scene.createDefaultCameraOrLight(true, true, true);

        // Attach camera controls to the canvas
        scene.activeCamera.attachControl(canvas, true);

        // main render loop – Babylon calls scene.render() every frame
        engine.runRenderLoop(() => {
          scene.render();
        });

        // make sure the canvas/engine resize when the browser window size changes
        window.addEventListener('resize', () => {
          engine.resize();
        });
      }

      // start everything once the module is loaded
      start();
    </script>
  </body>
</html>
